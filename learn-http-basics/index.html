<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222"><link rel="manifest" href="/images/site.webmanifest"><meta name="google-site-verification" content="k5HBUjLU81xJuWb8xJnZv0UgiQblDBrNU3i_164wuTI"><meta name="msvalidate.01" content="B8100FBA99CDE591E1C042A3608C96E9"><meta name="yandex-verification" content="d950e9c7ce2375f9"><meta name="baidu-site-verification" content="7CEDnF5GIr"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"blog.xyang.xin","root":"/","images":"/images","scheme":"Mist","version":"8.7.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta name="description" content="网络模型五层网络模型："><meta property="og:type" content="article"><meta property="og:title" content="学习 HTTP 协议笔记"><meta property="og:url" content="http://blog.xyang.xin/learn-http-basics/index.html"><meta property="og:site_name" content="韶 光"><meta property="og:description" content="网络模型五层网络模型："><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://images.xyang.xin/2020%2F09%2F03%2Fclassic-five-layer-model.jpg?x-oss-process=style/title_800"><meta property="og:image" content="https://images.xyang.xin/2020%2F09%2F03%2F16fb20a7abacc050.png?x-oss-process=style/title_800"><meta property="og:image" content="https://images.xyang.xin/2020%2F09%2F03%2Furi-url-urn.png"><meta property="og:image" content="http://images.xyang.xin/2020%2F09%2F04%2Fcookie-localstorage-sessionstorage.png"><meta property="article:published_time" content="2020-09-03T16:04:17.000Z"><meta property="article:modified_time" content="2021-08-22T09:12:42.507Z"><meta property="article:author" content="杨欣雨"><meta property="article:tag" content="http"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://images.xyang.xin/2020%2F09%2F03%2Fclassic-five-layer-model.jpg?x-oss-process=style/title_800"><link rel="canonical" href="http://blog.xyang.xin/learn-http-basics/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://blog.xyang.xin/learn-http-basics/","path":"learn-http-basics/","title":"学习 HTTP 协议笔记"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>学习 HTTP 协议笔记 | 韶 光</title><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="韶 光" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">韶 光</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Yang Xinyu's Personal Blog</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-信息技术"><a href="/categories/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/" rel="section"><i class="fa fa-bolt fa-fw"></i>信息技术</a></li><li class="menu-item menu-item-文化修养"><a href="/categories/%E4%BA%BA%E6%96%87%E4%BF%AE%E5%85%BB/" rel="section"><i class="fa fa-bookmark fa-fw"></i>文化修养</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.</span> <span class="nav-text">网络模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AE%E4%B8%BE%E4%BE%8B%E5%8F%8A%E5%8A%9F%E8%83%BD"><span class="nav-number">1.1.</span> <span class="nav-text">协议举例及功能</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82"><span class="nav-number">1.1.1.</span> <span class="nav-text">应用层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="nav-number">1.1.2.</span> <span class="nav-text">传输层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="nav-number">1.1.3.</span> <span class="nav-text">网络层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="nav-number">1.1.4.</span> <span class="nav-text">数据链路层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%B1%82"><span class="nav-number">1.1.5.</span> <span class="nav-text">物理层</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-%E5%8D%8F%E8%AE%AE%E5%8F%91%E5%B1%95%E5%8E%86%E5%8F%B2"><span class="nav-number">2.</span> <span class="nav-text">HTTP 协议发展历史</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-0-9"><span class="nav-number">2.1.</span> <span class="nav-text">HTTP&#x2F;0.9</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-1-0"><span class="nav-number">2.2.</span> <span class="nav-text">HTTP&#x2F;1.0</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-1-1"><span class="nav-number">2.3.</span> <span class="nav-text">HTTP&#x2F;1.1</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%8C%81%E4%B9%85%E8%BF%9E%E6%8E%A5%EF%BC%88persistent-connection%EF%BC%89"><span class="nav-number">2.3.1.</span> <span class="nav-text">1. 持久连接（persistent connection）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%AE%A1%E9%81%93%E6%9C%BA%E5%88%B6%EF%BC%88pipelining%EF%BC%89"><span class="nav-number">2.3.2.</span> <span class="nav-text">2. 管道机制（pipelining）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%85%B6%E4%BB%96"><span class="nav-number">2.3.3.</span> <span class="nav-text">3. 其他</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-2"><span class="nav-number">2.4.</span> <span class="nav-text">HTTP&#x2F;2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B"><span class="nav-number">3.</span> <span class="nav-text">三次握手</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#URI%E3%80%81URL%E5%92%8CURN%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">4.</span> <span class="nav-text">URI、URL和URN的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.</span> <span class="nav-text">HTTP 报文格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-%E7%8A%B6%E6%80%81%E7%A0%81"><span class="nav-number">6.</span> <span class="nav-text">HTTP 状态码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%A8%E5%9F%9F"><span class="nav-number">7.</span> <span class="nav-text">跨域</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-%E7%BC%93%E5%AD%98"><span class="nav-number">8.</span> <span class="nav-text">HTTP 缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cache-Control-%E5%A4%B4"><span class="nav-number">8.1.</span> <span class="nav-text">Cache-Control 头</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%93%E5%AD%98%E9%AA%8C%E8%AF%81"><span class="nav-number">8.2.</span> <span class="nav-text">缓存验证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Expire"><span class="nav-number">8.2.1.</span> <span class="nav-text">Expire</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Last-Modified"><span class="nav-number">8.2.2.</span> <span class="nav-text">Last-Modified</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Etag"><span class="nav-number">8.2.3.</span> <span class="nav-text">Etag</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cookie-%E5%92%8C-Session"><span class="nav-number">9.</span> <span class="nav-text">Cookie 和 Session</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%BF%E8%BF%9E%E6%8E%A5%E5%92%8C%E7%9F%AD%E8%BF%9E%E6%8E%A5"><span class="nav-number">10.</span> <span class="nav-text">长连接和短连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="nav-number">11.</span> <span class="nav-text">参考文献</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="杨欣雨" src="https://images.xyang.xin/2018-12/war-soldier.jpeg"><p class="site-author-name" itemprop="name">杨欣雨</p><div class="site-description" itemprop="description">韶华易逝，享受这欢乐的美妙时光。</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">41</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">4</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">43</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/yangxyo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yangxyo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zsh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_nd.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="http://www.ruanyifeng.com/blog/" title="http:&#x2F;&#x2F;www.ruanyifeng.com&#x2F;blog&#x2F;" rel="noopener" target="_blank">阮一峰的网络日志</a></li></ul></div></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://blog.xyang.xin/learn-http-basics/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://images.xyang.xin/2018-12/war-soldier.jpeg"><meta itemprop="name" content="杨欣雨"><meta itemprop="description" content="韶华易逝，享受这欢乐的美妙时光。"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="韶 光"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">学习 HTTP 协议笔记</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-09-03 16:04:17" itemprop="dateCreated datePublished" datetime="2020-09-03T16:04:17Z">2020-09-03</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-08-22 09:12:42" itemprop="dateModified" datetime="2021-08-22T09:12:42Z">2021-08-22</time></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="网络模型"><a href="#网络模型" class="headerlink" title="网络模型"></a>网络模型</h2><p>五层网络模型：<br><img data-src="https://images.xyang.xin/2020%2F09%2F03%2Fclassic-five-layer-model.jpg?x-oss-process=style/title_800" alt="classic-five-layer-model.jpg"></p><span id="more"></span><p><img data-src="https://images.xyang.xin/2020%2F09%2F03%2F16fb20a7abacc050.png?x-oss-process=style/title_800" alt="16fb20a7abacc050.png"><br>OSI 七层模型是国际标准化组织的标准，由于前者过于复杂且指定周期长，在整套标准推出之前，TCP/IP 模型就已经在全球范围内被广泛使用了，所以TCP/IP模型成了事实上的国际标准。我们在学习和开发中，将两者结合，这就是五层网络模型。</p><h3 id="协议举例及功能"><a href="#协议举例及功能" class="headerlink" title="协议举例及功能"></a>协议举例及功能</h3><h4 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h4><p>功能：为应用软件提供了很多服务。</p><p>协议： HTTP、DNS、FTP（文件传输）、SSH、Telnet、SMTP（电子邮件）</p><h4 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a>传输层</h4><p>功能：向用户提供可靠的端到端服务。</p><p>协议： TCP、UDP</p><h4 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h4><p>功能：寻址、路由。</p><p>协议：IPV4、IPV6、RARP、ICMP(V4、V6)</p><p>设备：路由器、三层交换机</p><h4 id="数据链路层"><a href="#数据链路层" class="headerlink" title="数据链路层"></a>数据链路层</h4><p>功能：在通信实体间建立数据链路连接。</p><p>协议：以太网、Wi-Fi</p><p>设备：网卡、交换机</p><h4 id="物理层"><a href="#物理层" class="headerlink" title="物理层"></a>物理层</h4><p>功能：定义物理设备如何传输数据。</p><p>设备：光纤、集线器、RJ-45接头</p><h2 id="HTTP-协议发展历史"><a href="#HTTP-协议发展历史" class="headerlink" title="HTTP 协议发展历史"></a>HTTP 协议发展历史</h2><h3 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP/0.9"></a>HTTP/0.9</h3><p>HTTP 最早版本是1991年发布的0.9版本。该版本有如下特点：</p><ol><li>只有一个命令<code>GET</code>。</li><li>没有<code>HEADER</code>等描述数据的信息。</li><li>协议规定，服务器只能回应HTML格式的字符串，不能回应别的格式。</li><li>服务器发送完毕，就关闭TCP连接。</li></ol><h3 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP/1.0"></a>HTTP/1.0</h3><p>1996年5月，HTTP/1.0发布，内容大大增加：</p><ol><li>任何格式的内容都可以发送。</li><li>新增<code>POST</code>和<code>HEAD</code>命令。</li><li>每次通信都必须包含头信息（HTTP header）。</li><li>新增状态码（status code）。</li><li>新增多字符集支持、多部分发送（multi-part type）、权限（authorization）、缓存（cache）、内容编码（content encoding）等。</li></ol><h3 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP/1.1"></a>HTTP/1.1</h3><p>1997年1月，HTTP/1.1 版本发布，至今（2020年）仍是最流行的版本。新增的功能有：</p><h4 id="1-持久连接（persistent-connection）"><a href="#1-持久连接（persistent-connection）" class="headerlink" title="1. 持久连接（persistent connection）"></a>1. 持久连接（persistent connection）</h4><p>即TCP连接默认不关闭，可以被多个请求复用。默认开启<code>Connection: keep-alive</code>。</p><p>客户端和服务器发现对方一段时间没有活动，就可以主动关闭连接。不过，规范的做法是，客户端在最后一个请求时，发送<code>Connection:close</code>，明确要求服务器关闭TCP连接。</p><p>目前，对于同一个域名，大多数浏览器允许同时建立6个持久连接。</p><h4 id="2-管道机制（pipelining）"><a href="#2-管道机制（pipelining）" class="headerlink" title="2. 管道机制（pipelining）"></a>2. 管道机制（pipelining）</h4><p>即在同一个TCP连接里面，客户端可以同时发送多个请求。</p><p>举例来说，客户端需要请求两个资源。以前的做法是，在同一个TCP连接里面，先发送A请求，然后等待服务器做出回应，收到后再发出B请求。管道机制则是允许浏览器同时发出A请求和B请求，但是服务器还是按照顺序，先回应A请求，完成后再回应B请求。</p><h4 id="3-其他"><a href="#3-其他" class="headerlink" title="3. 其他"></a>3. 其他</h4><p>新增动词方法：<code>PUT</code>、<code>PATCH</code>、<code>OPTIONS</code>、<code>DELETE</code></p><p>客户端请求头新增<code>Host</code>字段，用来指定服务器的域名。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Host: www.example.com</span><br></pre></td></tr></table></figure><p>有了<code>Host</code>字段，就可以将请求发往同一台服务器上的不同网站。虚拟主机技术就是利用的这一点。在apache，ngnix环境下，直接通过配置文件cfg文件来配置不同的域名和网站根目录之间的映射关系。</p><h3 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP/2"></a>HTTP/2</h3><ol><li>所有数据以二进制传输</li><li>多工。双向的、实时的通信，就叫做多工。举例来说，在一个TCP连接里面，服务器同时收到了A请求和B请求，于是先回应A请求，结果发现处理过程非常耗时，于是就发送A请求已经处理好的部分， 接着回应B请求，完成后，再发送A请求剩下的部分。</li><li>头信息压缩以及服务器推送等提高效率的功能。</li></ol><h2 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h2><p>进行三次握手的目的是连接服务器指定端口，建立TCP连接，并同步连接双方的序列号和确认号，交换TCP窗口大小信息。三次握手由客户端发起，第一次握手， 客户端创建一个请求数据包，指明客户端打算连接服务器的端口，发送完毕进入<code>SYN_SEND</code>状态；二次握手，服务器端发送确认包，进入<code>SYN_RCVD</code>状态；三次握手，客户端再次发送确认包。发送完毕后，客户端进入<code>ESTABILISHED</code>状态，服务器收到后也进入<code>ESTABLISHED</code>状态。</p><p>二次握手后客户端和服务器端本来已经相互通信，交换信息了，本来可以直接建立连接了。但是为什么要进行三次握手呢？</p><p>这是服务器端为防止服务器端误会客户端的意思，服务器端开启无用连接，而浪费资源。</p><p>这就好比，一个你一直有好感的女孩向你发了个信息，“我喜欢你”。收到消息，你激动不已，你发了封信息“我也爱你，咱们交往吧”，然后就辗转反侧等消息，整夜没睡。但是第二天女孩说，不好意思，人家是玩的真心话大冒险。二次握手，不可靠。就是这个道理。如果有良知的美丽女孩当天就应该给人家回信进行第三次握手，拒绝或者接受。</p><h2 id="URI、URL和URN的区别"><a href="#URI、URL和URN的区别" class="headerlink" title="URI、URL和URN的区别"></a>URI、URL和URN的区别</h2><p>URI(Uniform resource identifier) 统一资源标识符</p><p>URL(uniform resource locator) 统一资源定位器（网址）<br>URN(uniform resource name) 统一资源命名（ISBN 编码）</p><p>URL 是 URI，URN 也是 URI。URL 和 URN 两种兼备也是 URI。<br><img data-src="https://images.xyang.xin/2020%2F09%2F03%2Furi-url-urn.png" alt="uri-url-urn.png"><br>URN定义某事物的身份，而URL提供查找该事物的方法。</p><p>用于标识唯一书目的ISBN系统是一个典型的URN使用范例。例如，ISBN 0-486-27557-4无二义性地标识出莎士比亚的戏剧《罗密欧与朱丽叶》的某一特定版本。为获得该资源并阅读该书，人们需要它的位置，也就是一个URL地址。在类Unix操作系统中，一个典型的URL地址可能是一个文件目录，例如file:///home/username/RomeoAndJuliet.pdf。该URL标识出存储于本地硬盘中的电子书文件。因此，URL和URN有着互补的作用。</p><h2 id="HTTP-报文格式"><a href="#HTTP-报文格式" class="headerlink" title="HTTP 报文格式"></a>HTTP 报文格式</h2><p>请求报文：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;index.txt HTTP&#x2F;1.0</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_10_5)</span><br><span class="line">Accept: *&#x2F;*</span><br><span class="line">Accept-Language: en</span><br></pre></td></tr></table></figure><p>相应报文：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.0 200 OK </span><br><span class="line">Content-Type: text&#x2F;plain</span><br><span class="line">Content-Length: 137582</span><br><span class="line">Expires: Thu, 05 Dec 1997 16:00:00 GMT</span><br><span class="line">Last-Modified: Wed, 5 August 1996 15:55:28 GMT</span><br><span class="line">Server: Apache 0.84</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;body&gt;Hello World&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><blockquote><p>TIP：其中 <code>GET</code>、<code>POST</code>等命令是语义化的定义，<code>GET</code>请求一个数据，<code>POST</code>创建一个数据，但是他们都只是协议上规定的，不是强约束的，可以手动修改其行为，有点像HTML5标签。</p></blockquote><h2 id="HTTP-状态码"><a href="#HTTP-状态码" class="headerlink" title="HTTP 状态码"></a>HTTP 状态码</h2><p>响应分为五类：<br>100-199 服务器收到请求<br>200-299 成功响应<br>300-399 重定向<br>400-499 客户端错误<br>500-599 服务器错误</p><p>常见的状态码：<br>200 请求成功<br>301 永久重定向（浏览器会记住返回301的网址，下次直接访问另一个网址）<br>302 临时重定向（下次再访问旧网址，还是要先访问旧网址，再根据 location 访问新网址）<br>304 资源未被修改<br>403 没有权限<br>404 资源未找到<br>500 服务器遇到了不知道如何处理的问题<br>504 网关超时</p><h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><p>同源政策：协议、域名、端口号都相同则同源。如果不同源有如下限制：</p><ol><li>当前域下的 JS 脚本不能访问其他作用域的 cookie、localStorage 和 indexDB。</li><li>当前域下的 JS 脚本不能操作访问其他域下的 DOM。</li><li>当前域下的 ajax 无法发送跨域请求。</li></ol><p>通过 <code>http://127.0.0.1:8888</code> 获取到文件<code>index.html</code>，如果文件中有一段js脚本，请求<code>http://127.0.0.1:8887</code>的数据，也就是不同源的数据，浏览器会向8887服务器发送请求，并且接收返回内容，但是会检查是否有<code>Access-Control-Allow-Origin</code>头，并且设置为允许，就会将响应内容忽略掉，并返回错误。</p><p>解决办法：</p><ol><li>CORS。8887的服务端响应时可以添加<code>&quot;Access-Control-Allow-Origin&quot;:&quot;http://127.0.0.1:8888&quot;</code>消息头，允许跨域请求。通过<code>Access-Control-Allow-Headers:&quot;*&quot;</code>允许跨域请求时添加的某些请求头。</li><li>JSONP。浏览器允许<code>&lt;link&gt;</code>、<code>&lt;img&gt;</code>、<code>&lt;script&gt;</code> 在标签上写 URL 加载内容允许跨域。JSONP 就是在<code>&lt;script&gt;</code>上加载一个链接，向服务器请求JSON数据，服务器收到请求后，将数据放在一个指定名字的回调函数里传回来，客户端修改返回的内容。</li><li>WebSocket。该协议不实行同源政策，只要服务器支持，就可以实现跨域。</li><li>window.postMessage。HTML5的跨文档通信API，允许跨窗口通信，不论这两个窗口是否同源。</li><li>一级域名相同的域名，可以通过设置<code>document.domain=&quot;example.com&quot;</code>来共享Cookie。</li></ol><p>以上办法解决的跨域限制是不同的，例如：CORS、JSONP和WebSocket解决了AJAX跨域的问题。而<code>document.domain</code>解决了Cookie跨域的问题，<code>window.postMessage</code>解决了DOM跨域的问题。DOM跨域，典型的例子是<code>iframe</code>窗口和<code>window.open</code>方法打开的窗口，它们与父窗口无法通信。</p><h2 id="HTTP-缓存"><a href="#HTTP-缓存" class="headerlink" title="HTTP 缓存"></a>HTTP 缓存</h2><h3 id="Cache-Control-头"><a href="#Cache-Control-头" class="headerlink" title="Cache-Control 头"></a>Cache-Control 头</h3><p>HTTP/1.1 定义的<code>Cache-Control</code>头用来区分对缓存机制的支持情况，请求头和响应头都支持这个属性。通过它提供的不同值来定义缓存策略。<code>*</code>表示浏览器端常用的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; *缓存中不得存储任何关于客户端和服务端响应的内容。</span><br><span class="line">Cache-Control: no-store</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; *每次有请求发出时，缓存会将此请求发到服务器，服务器验证是否过期，</span><br><span class="line">&#x2F;&#x2F; 若未过期返回304，缓存才使用本地缓存副本。</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; *可以被任何中间人（中间代理、CDN等）缓存。</span><br><span class="line">Cache-Control: public</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; *中间人不能缓存此响应，该响应只能应用于浏览器私有缓存中。</span><br><span class="line">Cache-Control: private</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; *表示资源能够被缓存的最大时间。</span><br><span class="line">Cache-Control: max-age&#x3D;31536000</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 中间人的资源缓存时间将不使用max-age，而使用s-maxage。</span><br><span class="line">Cache-Control: s-maxage&#x3D;31536000</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; *保证已过期的缓存不被使用，必须从服务端重新获取请求。</span><br><span class="line">Cache-Control: must-revalidate</span><br><span class="line"></span><br><span class="line">Cache-Control: proxy-revalidate</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 浏览器特定时间内仍可使用过期的缓存。</span><br><span class="line">Cache-Control: max-stale &#x3D; 31536000</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 禁止中间人进行压缩、格式转换等。</span><br><span class="line">Cache-Control: no-transform</span><br></pre></td></tr></table></figure><h3 id="缓存验证"><a href="#缓存验证" class="headerlink" title="缓存验证"></a>缓存验证</h3><h4 id="Expire"><a href="#Expire" class="headerlink" title="Expire"></a>Expire</h4><p>Expire 是 HttpHeader 中代表资源的过期时间，由服务器端设置。如果带有 Expire ，则在 Expire 过期前不会发生 Http 请求，直接从缓存中读取。用户强制刷新例外（Windows:<code>ctrl+F5</code>，Mac:<code>command+option+R</code>），强制刷新是指无论如何都从服务器重新获取数据。</p><h4 id="Last-Modified"><a href="#Last-Modified" class="headerlink" title="Last-Modified"></a>Last-Modified</h4><p>Last-Modified 是 HttpHeader 中的资源的上次修改时间，如果带有 Last-Modified ，下一次发送 Http 请求时，将会发生带 If-modified-since 的 HttpHeader。与服务器端进行对比，如果没有过期，将会收到 304 的响应，从缓存中读取。</p><h4 id="Etag"><a href="#Etag" class="headerlink" title="Etag"></a>Etag</h4><p>Etag 是 HttpHeader 中代表资源的标签，在服务器端生成。如果带有 Etag ，下一次发送带 Etag 的请求，如果 Etag 没有变化将收到 304 的响应，从缓存中读取。<br>Etag 在使用时要注意相同资源多台 Web 服务器的 Etag 的一致性。所以分布式环境（比如CDN）很少使用ETag。</p><p>区别：<br>Expire 兼容 HTTP/1.0 浏览器。<br>Etag 更加严格的验证，可以可靠的比较指纹。<br>Last-Modified 不验证实际页面内容是否更改，对页面频繁更改的网页更加有利。</p><h2 id="Cookie-和-Session"><a href="#Cookie-和-Session" class="headerlink" title="Cookie 和 Session"></a>Cookie 和 Session</h2><p>Cookie 在服务端返回数据的时候通过<code>Set-Cookie</code>设置，浏览器获取Cookie后保存在本地，下次请求会自动带上，Cookie 是键值对，可以设置多个。<code>max-age</code>和<code>expires</code>设置过期时间，HttpOnly无法通过<code>document.cookie</code>访问。Session与之类似。<br>不过Session与Cookie不同之处在于，Cookie把数据放在客户端，而Session把数据放在服务器端。<br>将登陆信息等重要信息存放为Session，其他信息放在Cookie中。</p><p>Cookie, LocalStorage 与 SessionStorage 的区别：<br><img data-src="http://images.xyang.xin/2020%2F09%2F04%2Fcookie-localstorage-sessionstorage.png" alt="cookie-localstorage-sessionstorage.png"></p><h2 id="长连接和短连接"><a href="#长连接和短连接" class="headerlink" title="长连接和短连接"></a>长连接和短连接</h2><p>TCP 本身并没有长短连接的区别，长短与否，完全取决于我们怎么用它。</p><ul><li>短连接：每次通信时，创建 Socket；一次通信结束，调用 socket.close()。这就是一般意义上的短连接，短连接的好处是管理起来比较简单，存在的连接都是可用的连接，不需要额外的控制手段。</li><li>长连接：每次通信完毕后，不会关闭连接，这样可以做到连接的复用。长连接的好处是省去了创建连接的耗时。</li></ul><p>短连接和长连接的优势，分别是对方的劣势。想要图简单，不追求高性能，使用短连接合适，这样我们就不需要操心连接状态的管理；想要追求性能，使用长连接，我们就需要担心各种问题：比如 端对端连接的维护，连接的保活。</p><p>HTTP1.1规定了默认保持长连接（HTTP persistent connection ，也有翻译为持久连接），数据传输完成了保持TCP连接不断开（不发RST包、不四次握手），等待在同域名下继续用这个通道传输数据；相反的就是短连接。</p><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul><li><a target="_blank" rel="noopener" href="https://coding.imooc.com/class/225.html">HTTP协议原理+实践 Web开发工程师必学-慕课网实战</a></li><li><a target="_blank" rel="noopener" href="https://juejin.im/post/6844904049800642568">详解 四层、五层、七层 计算机网络模型 - 掘金</a></li><li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E5%B1%82">应用层 - 维基百科，自由的百科全书</a></li><li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E5%B1%82">网络层 - 维基百科，自由的百科全书</a></li><li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82">数据链路层 - 维基百科，自由的百科全书</a></li><li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%89%A9%E7%90%86%E5%B1%82">物理层 - 维基百科，自由的百科全书</a></li><li><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/08/http.html">HTTP 协议入门 - 阮一峰的网络日志</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/walkingmanc/article/details/49363869">同一个ip通一个80端口部署多个网站的原理-虚拟主机技术本质解析_walkingmanc的专栏-CSDN博客</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhanghongzheng3213/article/details/79855775">TCP为什么需要3次握手与4次挥手_zhanghongzheng3213的专栏-CSDN博客</a></li><li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%BB%9F%E4%B8%80%E8%B5%84%E6%BA%90%E6%A0%87%E5%BF%97%E7%AC%A6">统一资源标志符 - 维基百科，自由的百科全书</a></li><li><a target="_blank" rel="noopener" href="https://github.com/CavsZhouyou/Front-End-Interview-Notebook/blob/master/JavaScript/JavaScript.md">Front-End-Interview-Notebook/JavaScript.md at master · CavsZhouyou/Front-End-Interview-Notebook</a></li><li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html">浏览器同源政策及其规避方法 - 阮一峰的网络日志</a></li><li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ">HTTP 缓存 - HTTP | MDN</a></li><li><a target="_blank" rel="noopener" href="https://www.iteye.com/blog/coolfiry-1189525">【技术心得】Last-Modified,Etag,Expire区别 - coolfiry - ITeye博客</a></li><li><a target="_blank" rel="noopener" href="https://jerryzou.com/posts/cookie-and-web-storage/">详说 Cookie, LocalStorage 与 SessionStorage | 咀嚼之味</a></li><li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/0c4de17dd6bc">Tcp长连接和keepalive - 简书</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/duanxz/p/3623486.html">HTTP协议中的长连接和短连接（keep-alive状态） - duanxz - 博客园</a></li></ul></div><footer class="post-footer"><div class="followme"><span>欢迎关注我的其它发布渠道</span><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i></span> <span class="label">RSS</span></a></div></div></div><div class="post-tags"><a href="/tags/http/" rel="tag"># http</a></div><div class="post-nav"><div class="post-nav-item"><a href="/css-everday-1/" rel="prev" title="position ——【每天一点 CSS】"><i class="fa fa-chevron-left"></i> position ——【每天一点 CSS】</a></div><div class="post-nav-item"><a href="/leetcode-142/" rel="next" title="环形链表">环形链表<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">渝ICP备17015144号</a></div><div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">杨欣雨</span></div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="/js/third-party/search/local-search.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous"><script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"yangxyo","repo":"https://github.com/yangxyo/gitalk","client_id":"d132f60a332d75ac74e8","client_secret":"e1b396f1311291af51db16ed51308c275bc383e7","admin_user":"yangxyo","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/yangxyo/gitalk","language":null,"js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"6e3cb859fd14b422ac7dc05858006c76"}</script><script src="/js/third-party/comments/gitalk.js"></script></body></html>